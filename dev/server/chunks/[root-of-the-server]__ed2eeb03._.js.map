{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\r\nconst ADMIN_EMAIL = process.env.ADMIN_EMAIL || 'tempacc.akash@gmail.com';\r\nconst ADMIN_PASSWORD_HASH = process.env.ADMIN_PASSWORD_HASH || '$2a$12$F1imBncHnVihTH4mpwAdju/2wbHidQKQKEUpK0pAWIREZjsxvwcw.'; // 'Akrsh@gmail.com'\r\n\r\nexport interface User {\r\n  email: string;\r\n  username: string;\r\n  role: 'admin';\r\n}\r\n\r\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\r\n  try {\r\n    return await bcrypt.compare(password, hash);\r\n  } catch (error) {\r\n    console.error('bcrypt.compare error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return bcrypt.hash(password, 12);\r\n}\r\n\r\nexport function generateToken(user: User): string {\r\n  return jwt.sign(\r\n    { email: user.email, username: user.username, role: user.role },\r\n    JWT_SECRET,\r\n    { expiresIn: '24h' }\r\n  );\r\n}\r\n\r\nexport function verifyToken(token: string): User | null {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as any;\r\n    return {\r\n      email: decoded.email,\r\n      username: decoded.username || decoded.email.split('@')[0],\r\n      role: decoded.role\r\n    };\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function authenticateUser(email: string, password: string): Promise<User | null> {\r\n  if (email !== ADMIN_EMAIL) {\r\n    return null;\r\n  }\r\n\r\n  const isValid = await verifyPassword(password, ADMIN_PASSWORD_HASH);\r\n  if (!isValid) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    email,\r\n    username: email.split('@')[0],\r\n    role: 'admin'\r\n  };\r\n}\r\n\r\nexport function getTokenFromRequest(request: Request): string | null {\r\n  const authHeader = request.headers.get('authorization');\r\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n    return null;\r\n  }\r\n  return authHeader.substring(7);\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C,MAAM,sBAAsB,QAAQ,GAAG,CAAC,mBAAmB,IAAI,gEAAgE,oBAAoB;AAQ5I,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,IAAI;QACF,OAAO,MAAM,0LAAM,CAAC,OAAO,CAAC,UAAU;IACxC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;IACT;AACF;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,0LAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,SAAS,cAAc,IAAU;IACtC,OAAO,8LAAG,CAAC,IAAI,CACb;QAAE,OAAO,KAAK,KAAK;QAAE,UAAU,KAAK,QAAQ;QAAE,MAAM,KAAK,IAAI;IAAC,GAC9D,YACA;QAAE,WAAW;IAAM;AAEvB;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,8LAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;YACL,OAAO,QAAQ,KAAK;YACpB,UAAU,QAAQ,QAAQ,IAAI,QAAQ,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACzD,MAAM,QAAQ,IAAI;QACpB;IACF,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,iBAAiB,KAAa,EAAE,QAAgB;IACpE,IAAI,UAAU,aAAa;QACzB,OAAO;IACT;IAEA,MAAM,UAAU,MAAM,eAAe,UAAU;IAC/C,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,OAAO;QACL;QACA,UAAU,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;QAC7B,MAAM;IACR;AACF;AAEO,SAAS,oBAAoB,OAAgB;IAClD,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;QACpD,OAAO;IACT;IACA,OAAO,WAAW,SAAS,CAAC;AAC9B","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { authenticateUser, generateToken } from '@/lib/auth';\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password } = await request.json();\r\n\r\n    if (!email || !password) {\r\n      return NextResponse.json(\r\n        { error: 'Email and password are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const user = await authenticateUser(email, password);\r\n    if (!user) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid credentials' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const token = generateToken(user);\r\n\r\n    const response = NextResponse.json(\r\n      { \r\n        message: 'Login successful',\r\n        user: { email: user.email, username: user.username, role: user.role }\r\n      },\r\n      { status: 200 }\r\n    );\r\n\r\n    // Set HTTP-only cookie\r\n    response.cookies.set('auth-token', token, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === 'production',\r\n      sameSite: 'strict',\r\n      maxAge: 24 * 60 * 60, // 24 hours\r\n      path: '/',\r\n    });\r\n\r\n    return response;\r\n  } catch (error) {\r\n    console.error('Login error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Internal server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,IAAA,oLAAgB,EAAC,OAAO;QAC3C,IAAI,CAAC,MAAM;YACT,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,IAAA,iLAAa,EAAC;QAE5B,MAAM,WAAW,4LAAY,CAAC,IAAI,CAChC;YACE,SAAS;YACT,MAAM;gBAAE,OAAO,KAAK,KAAK;gBAAE,UAAU,KAAK,QAAQ;gBAAE,MAAM,KAAK,IAAI;YAAC;QACtE,GACA;YAAE,QAAQ;QAAI;QAGhB,uBAAuB;QACvB,SAAS,OAAO,CAAC,GAAG,CAAC,cAAc,OAAO;YACxC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACR;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,4LAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}