{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\r\nconst ADMIN_EMAIL = process.env.ADMIN_EMAIL || 'tempacc.akash@gmail.com';\r\nconst ADMIN_PASSWORD_HASH = process.env.ADMIN_PASSWORD_HASH || '$2a$12$F1imBncHnVihTH4mpwAdju/2wbHidQKQKEUpK0pAWIREZjsxvwcw.'; // 'Akrsh@gmail.com'\r\n\r\nexport interface User {\r\n  email: string;\r\n  username: string;\r\n  role: 'admin';\r\n}\r\n\r\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\r\n  try {\r\n    return await bcrypt.compare(password, hash);\r\n  } catch (error) {\r\n    console.error('bcrypt.compare error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return bcrypt.hash(password, 12);\r\n}\r\n\r\nexport function generateToken(user: User): string {\r\n  return jwt.sign(\r\n    { email: user.email, username: user.username, role: user.role },\r\n    JWT_SECRET,\r\n    { expiresIn: '24h' }\r\n  );\r\n}\r\n\r\nexport function verifyToken(token: string): User | null {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as any;\r\n    return {\r\n      email: decoded.email,\r\n      username: decoded.username || decoded.email.split('@')[0],\r\n      role: decoded.role\r\n    };\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function authenticateUser(email: string, password: string): Promise<User | null> {\r\n  if (email !== ADMIN_EMAIL) {\r\n    return null;\r\n  }\r\n\r\n  const isValid = await verifyPassword(password, ADMIN_PASSWORD_HASH);\r\n  if (!isValid) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    email,\r\n    username: email.split('@')[0],\r\n    role: 'admin'\r\n  };\r\n}\r\n\r\nexport function getTokenFromRequest(request: Request): string | null {\r\n  const authHeader = request.headers.get('authorization');\r\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n    return null;\r\n  }\r\n  return authHeader.substring(7);\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C,MAAM,sBAAsB,QAAQ,GAAG,CAAC,mBAAmB,IAAI,gEAAgE,oBAAoB;AAQ5I,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,IAAI;QACF,OAAO,MAAM,0LAAM,CAAC,OAAO,CAAC,UAAU;IACxC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;IACT;AACF;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,0LAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,SAAS,cAAc,IAAU;IACtC,OAAO,8LAAG,CAAC,IAAI,CACb;QAAE,OAAO,KAAK,KAAK;QAAE,UAAU,KAAK,QAAQ;QAAE,MAAM,KAAK,IAAI;IAAC,GAC9D,YACA;QAAE,WAAW;IAAM;AAEvB;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,8LAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;YACL,OAAO,QAAQ,KAAK;YACpB,UAAU,QAAQ,QAAQ,IAAI,QAAQ,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACzD,MAAM,QAAQ,IAAI;QACpB;IACF,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,iBAAiB,KAAa,EAAE,QAAgB;IACpE,IAAI,UAAU,aAAa;QACzB,OAAO;IACT;IAEA,MAAM,UAAU,MAAM,eAAe,UAAU;IAC/C,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,OAAO;QACL;QACA,UAAU,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;QAC7B,MAAM;IACR;AACF;AAEO,SAAS,oBAAoB,OAAgB;IAClD,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;QACpD,OAAO;IACT;IACA,OAAO,WAAW,SAAS,CAAC;AAC9B","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/app/api/auth/verify/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { verifyToken } from '@/lib/auth';\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const token = request.cookies.get('auth-token')?.value;\r\n\r\n    if (!token) {\r\n      return NextResponse.json(\r\n        { error: 'No token provided' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const user = verifyToken(token);\r\n    if (!user) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid token' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { user: { username: user.username, role: user.role } },\r\n      { status: 200 }\r\n    );\r\n  } catch (error) {\r\n    console.error('Token verification error:', error);\r\n    return NextResponse.json(\r\n      { error: 'Internal server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;QAEjD,IAAI,CAAC,OAAO;YACV,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAoB,GAC7B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,IAAA,+KAAW,EAAC;QACzB,IAAI,CAAC,MAAM;YACT,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgB,GACzB;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,4LAAY,CAAC,IAAI,CACtB;YAAE,MAAM;gBAAE,UAAU,KAAK,QAAQ;gBAAE,MAAM,KAAK,IAAI;YAAC;QAAE,GACrD;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,4LAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}