{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\r\nconst ADMIN_EMAIL = process.env.ADMIN_EMAIL || 'tempacc.akash@gmail.com';\r\nconst ADMIN_PASSWORD_HASH = process.env.ADMIN_PASSWORD_HASH || '$2a$12$F1imBncHnVihTH4mpwAdju/2wbHidQKQKEUpK0pAWIREZjsxvwcw.'; // 'Akrsh@gmail.com'\r\n\r\nexport interface User {\r\n  email: string;\r\n  username: string;\r\n  role: 'admin';\r\n}\r\n\r\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\r\n  try {\r\n    return await bcrypt.compare(password, hash);\r\n  } catch (error) {\r\n    console.error('bcrypt.compare error:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function hashPassword(password: string): Promise<string> {\r\n  return bcrypt.hash(password, 12);\r\n}\r\n\r\nexport function generateToken(user: User): string {\r\n  return jwt.sign(\r\n    { email: user.email, username: user.username, role: user.role },\r\n    JWT_SECRET,\r\n    { expiresIn: '24h' }\r\n  );\r\n}\r\n\r\nexport function verifyToken(token: string): User | null {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as any;\r\n    return {\r\n      email: decoded.email,\r\n      username: decoded.username || decoded.email.split('@')[0],\r\n      role: decoded.role\r\n    };\r\n  } catch (error) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function authenticateUser(email: string, password: string): Promise<User | null> {\r\n  if (email !== ADMIN_EMAIL) {\r\n    return null;\r\n  }\r\n\r\n  const isValid = await verifyPassword(password, ADMIN_PASSWORD_HASH);\r\n  if (!isValid) {\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    email,\r\n    username: email.split('@')[0],\r\n    role: 'admin'\r\n  };\r\n}\r\n\r\nexport function getTokenFromRequest(request: Request): string | null {\r\n  const authHeader = request.headers.get('authorization');\r\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n    return null;\r\n  }\r\n  return authHeader.substring(7);\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAC7C,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAC/C,MAAM,sBAAsB,QAAQ,GAAG,CAAC,mBAAmB,IAAI,gEAAgE,oBAAoB;AAQ5I,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,IAAI;QACF,OAAO,MAAM,0LAAM,CAAC,OAAO,CAAC,UAAU;IACxC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;IACT;AACF;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,0LAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,SAAS,cAAc,IAAU;IACtC,OAAO,8LAAG,CAAC,IAAI,CACb;QAAE,OAAO,KAAK,KAAK;QAAE,UAAU,KAAK,QAAQ;QAAE,MAAM,KAAK,IAAI;IAAC,GAC9D,YACA;QAAE,WAAW;IAAM;AAEvB;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,8LAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;YACL,OAAO,QAAQ,KAAK;YACpB,UAAU,QAAQ,QAAQ,IAAI,QAAQ,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;YACzD,MAAM,QAAQ,IAAI;QACpB;IACF,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAEO,eAAe,iBAAiB,KAAa,EAAE,QAAgB;IACpE,IAAI,UAAU,aAAa;QACzB,OAAO;IACT;IAEA,MAAM,UAAU,MAAM,eAAe,UAAU;IAC/C,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,OAAO;QACL;QACA,UAAU,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;QAC7B,MAAM;IACR;AACF;AAEO,SAAS,oBAAoB,OAAgB;IAClD,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;QACpD,OAAO;IACT;IACA,OAAO,WAAW,SAAS,CAAC;AAC9B","debugId":null}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/lib/middleware-auth.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { verifyToken } from './auth';\r\n\r\nexport function withAuth(handler: (request: NextRequest, ...args: any[]) => Promise<NextResponse>) {\r\n  return async (request: NextRequest, ...args: any[]) => {\r\n    try {\r\n      const token = request.cookies.get('auth-token')?.value;\r\n\r\n      if (!token) {\r\n        return NextResponse.json(\r\n          { error: 'Authentication required' },\r\n          { status: 401 }\r\n        );\r\n      }\r\n\r\n      const user = verifyToken(token);\r\n      if (!user) {\r\n        return NextResponse.json(\r\n          { error: 'Invalid or expired token' },\r\n          { status: 401 }\r\n        );\r\n      }\r\n\r\n      // Add user to request context\r\n      (request as any).user = user;\r\n\r\n      return handler(request, ...args);\r\n    } catch (error) {\r\n      console.error('Auth middleware error:', error);\r\n      return NextResponse.json(\r\n        { error: 'Authentication failed' },\r\n        { status: 401 }\r\n      );\r\n    }\r\n  };\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,SAAS,OAAwE;IAC/F,OAAO,OAAO,SAAsB,GAAG;QACrC,IAAI;YACF,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;YAEjD,IAAI,CAAC,OAAO;gBACV,OAAO,4LAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAA0B,GACnC;oBAAE,QAAQ;gBAAI;YAElB;YAEA,MAAM,OAAO,IAAA,+KAAW,EAAC;YACzB,IAAI,CAAC,MAAM;gBACT,OAAO,4LAAY,CAAC,IAAI,CACtB;oBAAE,OAAO;gBAA2B,GACpC;oBAAE,QAAQ;gBAAI;YAElB;YAEA,8BAA8B;YAC7B,QAAgB,IAAI,GAAG;YAExB,OAAO,QAAQ,YAAY;QAC7B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAwB,GACjC;gBAAE,QAAQ;YAAI;QAElB;IACF;AACF","debugId":null}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AkashSharma/Documents/GitHub/webpage/Brocan%2BBlogs/nextjs-mdx-blog/src/app/api/admin/create-post/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport { withAuth } from '@/lib/middleware-auth';\r\n\r\nasync function createPostHandler(request: NextRequest) {\r\n  try {\r\n    const { slug, content } = await request.json();\r\n\r\n    if (!slug || !content) {\r\n      return NextResponse.json(\r\n        { error: 'Slug and content are required' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Validate slug format\r\n    const validSlug = /^[a-z0-9-]+$/.test(slug);\r\n    if (!validSlug) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid slug format. Use only lowercase letters, numbers, and hyphens.' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const postsDirectory = path.join(process.cwd(), 'src/content/posts');\r\n    const filePath = path.join(postsDirectory, `${slug}.mdx`);\r\n\r\n    // Check if file already exists\r\n    if (fs.existsSync(filePath)) {\r\n      return NextResponse.json(\r\n        { error: 'A blog post with this title already exists' },\r\n        { status: 409 }\r\n      );\r\n    }\r\n\r\n    // Ensure the posts directory exists\r\n    if (!fs.existsSync(postsDirectory)) {\r\n      fs.mkdirSync(postsDirectory, { recursive: true });\r\n    }\r\n\r\n    // Write the file\r\n    fs.writeFileSync(filePath, content, 'utf8');\r\n\r\n    return NextResponse.json(\r\n      { \r\n        message: 'Blog post created successfully',\r\n        slug,\r\n        filePath: `src/content/posts/${slug}.mdx`\r\n      },\r\n      { status: 201 }\r\n    );\r\n\r\n  } catch (error) {\r\n    console.error('Error creating blog post:', error);\r\n    return NextResponse.json(\r\n      { error: 'Internal server error' },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport const POST = withAuth(createPostHandler);"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,eAAe,kBAAkB,OAAoB;IACnD,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE5C,IAAI,CAAC,QAAQ,CAAC,SAAS;YACrB,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgC,GACzC;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,YAAY,eAAe,IAAI,CAAC;QACtC,IAAI,CAAC,WAAW;YACd,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyE,GAClF;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QAChD,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,gBAAgB,GAAG,KAAK,IAAI,CAAC;QAExD,+BAA+B;QAC/B,IAAI,wGAAE,CAAC,UAAU,CAAC,WAAW;YAC3B,OAAO,4LAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA6C,GACtD;gBAAE,QAAQ;YAAI;QAElB;QAEA,oCAAoC;QACpC,IAAI,CAAC,wGAAE,CAAC,UAAU,CAAC,iBAAiB;YAClC,wGAAE,CAAC,SAAS,CAAC,gBAAgB;gBAAE,WAAW;YAAK;QACjD;QAEA,iBAAiB;QACjB,wGAAE,CAAC,aAAa,CAAC,UAAU,SAAS;QAEpC,OAAO,4LAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT;YACA,UAAU,CAAC,kBAAkB,EAAE,KAAK,IAAI,CAAC;QAC3C,GACA;YAAE,QAAQ;QAAI;IAGlB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,4LAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,MAAM,OAAO,IAAA,0LAAQ,EAAC","debugId":null}}]
}